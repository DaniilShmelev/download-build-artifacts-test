steps:
- bash: mkdir -p artifacts/someDir
- bash: echo "some content 1" > artifacts/someFile1.txt
- bash: echo "some content 2" > artifacts/someDir/someFile2.txt

- task: PublishBuildArtifactsM@1
  inputs:
    PathtoPublish: 'artifacts/someFile1.txt'
    ArtifactName: 'drop1'
    publishLocation: 'FilePath'
    TargetPath: 'D:/artifacts'
- task: PublishBuildArtifactsM@1
  inputs:
    PathtoPublish: 'artifacts/someDir'
    ArtifactName: 'drop2'
    publishLocation: 'FilePath'
    TargetPath: 'D:/artifacts'
- task: DownloadBuildArtifactsM@0
  inputs:
    buildType: 'current'
    downloadType: 'single'
    artifactName: 'drop1'
    downloadPath: 'artifacts'
    extractTars: false
- task: DownloadBuildArtifactsM@0
  inputs:
    buildType: 'current'
    downloadType: 'single'
    artifactName: 'drop2'
    downloadPath: 'artifacts'
    extractTars: false
- bash: ls -lR artifacts
  displayName: 'File permissions after'
